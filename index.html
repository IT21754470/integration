<!DOCTYPE html> 
<html> 
<head>
    <meta charset="utf-8">
    <title>AR Classroom (Smaller)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>     
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    
    <style>
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: Arial, sans-serif;
            z-index: 9999;
        }
        
        #debug {
            position: fixed;
            bottom: 10px;
            left: 10px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px;
            font-family: monospace;
            font-size: 12px;
            border-radius: 4px;
            z-index: 100;
        }
    </style>
    
    <script>         
        // This function will run after the scene loads         
        AFRAME.registerComponent('classroom', {             
            init: function() {                 
                // Create student desks in rows
                // REDUCED number of desks and spacing
                const rows = 2;                 
                const desksPerRow = 2;                 
                const startX = -0.8;  // Closer to center              
                const startZ = 0.4;   // Closer to marker                
                const spacingX = 0.6; // Smaller spacing              
                const spacingZ = 0.6; // Smaller spacing                                
                const scene = document.querySelector('a-marker');                                  
                
                // Create rows of desks                 
                for (let row = 0; row < rows; row++) {                     
                    for (let desk = 0; desk < desksPerRow; desk++) {                         
                        // Calculate position                         
                        const xPos = startX + (desk * spacingX);                         
                        const zPos = startZ + (row * spacingZ);                                                  
                        
                        // Create and add the chair-table combination
                        // REDUCED SIZE of student desks                   
                        const studentDesk = document.createElement('a-entity');                         
                        studentDesk.setAttribute('gltf-model', './chair_table.glb');                         
                        studentDesk.setAttribute('position', {x: xPos, y: 0, z: zPos});                         
                        studentDesk.setAttribute('rotation', {x: 0, y: 90, z: 0});                         
                        studentDesk.setAttribute('scale', {x: 0.25, y: 0.25, z: 0.25});                                                  
                        
                        scene.appendChild(studentDesk);                     
                    }                 
                }             
            }         
        });     
    </script> 
</head> 
<body style='margin: 0; overflow: hidden;'>
    <div id="loading-screen">
        <div>Loading AR Classroom...</div>
    </div>
    
    <div id="debug">Initializing...</div>
    
    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: true;">         
        <a-marker preset="hiro" classroom>
            <!-- Floor - REDUCED SIZE -->             
            <a-entity                  
                gltf-model="./checkered_tile_floor.glb"                  
                position="0 -0.2 0.2"                  
                rotation="0 0 0"                  
                scale="0.05 0.25 0.05">             
            </a-entity>                          
            
            <!-- Teacher's desk - REDUCED SIZE and MOVED CLOSER -->             
            <a-entity                  
                gltf-model="./teacher_desk.glb"                  
                position="0 0 -0.8"                  
                rotation="0 360 0"                  
                scale="0.5 0.5 0.5">             
            </a-entity>                          
            
            <!-- Teacher's chair - REDUCED SIZE and MOVED CLOSER -->             
            <a-entity                  
                gltf-model="./teacher-chair.glb"                  
                position="0 0.1 -1.2"                  
                rotation="0 0 0"                  
                scale="0.8 0.8 0.8">             
            </a-entity>                          
            
            <!-- Mini cupboard - REDUCED SIZE and MOVED CLOSER -->             
            <a-entity                  
                gltf-model="./mini-cupboard.glb"                  
                position="1.2 0 -1.8"                  
                rotation="0 90 0"                  
                scale="0.15 0.15 0.15">             
            </a-entity>
            
            <!-- Whiteboard - REDUCED SIZE and MOVED CLOSER -->
            <a-entity
                gltf-model="./whiteboard.glb"
                position="0 0.3 -1.8"
                rotation="0 90 0"
                scale="0.08 0.08 0.08">
            </a-entity>
            
            <!-- Fallback objects if models don't load -->
            <a-box position="0 0.3 -1.8" width="1.5" height="0.8" depth="0.05" color="white" visible="false" id="backup-whiteboard"></a-box>
            <a-box position="0 0 -0.8" width="0.8" height="0.3" depth="0.4" color="brown" visible="false" id="backup-desk"></a-box>
        </a-marker>         
        <a-entity camera></a-entity>     
    </a-scene> 
    
    <script>
        const loadingScreen = document.getElementById('loading-screen');
        const debug = document.getElementById('debug');
        
        // Scene loaded event
        document.querySelector('a-scene').addEventListener('loaded', function () {
            debug.textContent = "AR scene loaded. Show the HIRO marker...";
            loadingScreen.style.display = 'none';
            
            // Check for iOS
            if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
                debug.textContent = "iOS detected. If camera doesn't start, check permissions.";
            }
        });
        
        // Marker detection events
        document.querySelector('a-marker').addEventListener('markerFound', function() {
            debug.textContent = "Marker found! Classroom visible.";
        });
        
        document.querySelector('a-marker').addEventListener('markerLost', function() {
            debug.textContent = "Marker lost. Show the HIRO marker to camera.";
        });
        
        // Hide debug after 10 seconds
        setTimeout(() => {
            debug.style.opacity = '0.5';
        }, 10000);
    </script>
</body> 
</html>
